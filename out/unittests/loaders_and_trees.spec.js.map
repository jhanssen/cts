{"version":3,"sources":["../../src/unittests/loaders_and_trees.spec.ts"],"names":["description","TestFileLoader","Logger","parseQuery","TestQuerySingleCase","TestQueryMultiCase","TestQueryMultiTest","TestQueryMultiFile","makeTestGroup","makeTestGroupForUnitTesting","assert","objectEquals","UnitTest","listingData","suite1","file","readme","suite2","specsData","g","test","fn","params","x","a","b","_c","t","debug","fail","FakeTestFileLoader","listing","suite","import","path","LoadingTest","loader","load","query","Array","from","loadCases","loadNames","map","c","toString","shouldReject","expect","length","s","runTestcase","log","testcases","i","expectations","status","logs","name","rec","res","record","run","results","get","timems","undefined","l","JSON","stringify","startsWith","indexOf","zedCases","zedExpectationsSkipA1B2","expectation","zedExpectationsSkipA1B0","zedExpectationsSkipB3","zedExpectationsSkipA1","zedExpectationsSkipZed","suite1Cases","expectationsSkipAllInBaz","expectationsSkipAllInFoo","expectationsSkipAll","suite2Cases","expectedFailures","testIterateCollapsed","expectedResult","includeEmptySubtrees","treePromise","loadTree","tree","actual","iterateCollapsedQueries","q","join"],"mappings":"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","sourcesContent":["export const description = `\nTests for queries/filtering, loading, and running.\n`;\n\nimport { TestFileLoader, SpecFile } from '../common/framework/file_loader.js';\nimport { Fixture } from '../common/framework/fixture.js';\nimport { Logger } from '../common/framework/logging/logger.js';\nimport { Status } from '../common/framework/logging/result.js';\nimport { parseQuery } from '../common/framework/query/parseQuery.js';\nimport {\n  TestQuery,\n  TestQuerySingleCase,\n  TestQueryMultiCase,\n  TestQueryMultiTest,\n  TestQueryMultiFile,\n  TestQueryWithExpectation,\n} from '../common/framework/query/query.js';\nimport { makeTestGroup, makeTestGroupForUnitTesting } from '../common/framework/test_group.js';\nimport { TestSuiteListing, TestSuiteListingEntry } from '../common/framework/test_suite_listing.js';\nimport { TestTreeLeaf } from '../common/framework/tree.js';\nimport { assert, objectEquals } from '../common/framework/util/util.js';\n\nimport { UnitTest } from './unit_test.js';\n\nconst listingData: { [k: string]: TestSuiteListingEntry[] } = {\n  suite1: [\n    { file: [], readme: 'desc 1a' },\n    { file: ['foo'] },\n    { file: ['bar'], readme: 'desc 1h' },\n    { file: ['bar', 'biz'] },\n    { file: ['bar', 'buzz', 'buzz'] },\n    { file: ['baz'] },\n    { file: ['empty'], readme: 'desc 1z' }, // directory with no files\n  ],\n  suite2: [{ file: [], readme: 'desc 2a' }, { file: ['foof'] }],\n};\n\nconst specsData: { [k: string]: SpecFile } = {\n  'suite1/foo.spec.js': {\n    description: 'desc 1b',\n    g: (() => {\n      const g = makeTestGroupForUnitTesting(UnitTest);\n      g.test('hello').fn(() => {});\n      g.test('bonjour').fn(() => {});\n      g.test('hola').fn(() => {});\n      return g;\n    })(),\n  },\n  'suite1/bar/biz.spec.js': {\n    description: 'desc 1f',\n    g: makeTestGroupForUnitTesting(UnitTest), // file with no tests\n  },\n  'suite1/bar/buzz/buzz.spec.js': {\n    description: 'desc 1d',\n    g: (() => {\n      const g = makeTestGroupForUnitTesting(UnitTest);\n      g.test('zap').fn(() => {});\n      return g;\n    })(),\n  },\n  'suite1/baz.spec.js': {\n    description: 'desc 1e',\n    g: (() => {\n      const g = makeTestGroupForUnitTesting(UnitTest);\n      g.test('wye')\n        .params([{}, { x: 1 }])\n        .fn(() => {});\n      g.test('zed')\n        .params([\n          { a: 1, b: 2, _c: 0 },\n          { b: 3, a: 1, _c: 0 },\n        ])\n        .fn(() => {});\n      return g;\n    })(),\n  },\n  'suite2/foof.spec.js': {\n    description: 'desc 2b',\n    g: (() => {\n      const g = makeTestGroupForUnitTesting(UnitTest);\n      g.test('blah').fn(t => {\n        t.debug('OK');\n      });\n      g.test('bleh')\n        .params([{ a: 1 }])\n        .fn(t => {\n          t.debug('OK');\n          t.debug('OK');\n        });\n      g.test('bluh,a').fn(t => {\n        t.fail('goodbye');\n      });\n      return g;\n    })(),\n  },\n};\n\nclass FakeTestFileLoader extends TestFileLoader {\n  async listing(suite: string): Promise<TestSuiteListing> {\n    return listingData[suite];\n  }\n\n  async import(path: string): Promise<SpecFile> {\n    assert(path in specsData, '[test] mock file ' + path + ' does not exist');\n    return specsData[path];\n  }\n}\n\nclass LoadingTest extends UnitTest {\n  static readonly loader = new FakeTestFileLoader();\n\n  async load(query: string): Promise<TestTreeLeaf[]> {\n    return Array.from(await LoadingTest.loader.loadCases(parseQuery(query)));\n  }\n\n  async loadNames(query: string): Promise<string[]> {\n    return (await this.load(query)).map(c => c.query.toString());\n  }\n}\n\nexport const g = makeTestGroup(LoadingTest);\n\ng.test('suite').fn(async t => {\n  t.shouldReject('Error', t.load('suite1'));\n  t.shouldReject('Error', t.load('suite1:'));\n});\n\ng.test('group').fn(async t => {\n  t.expect((await t.load('suite1:*')).length === 8);\n  t.expect((await t.load('suite1:foo,*')).length === 3); // x:foo,* matches x:foo:\n  t.expect((await t.load('suite1:bar,*')).length === 1);\n  t.expect((await t.load('suite1:bar,buzz,buzz,*')).length === 1);\n\n  t.shouldReject('Error', t.load('suite1:f*'));\n\n  {\n    const s = new TestQueryMultiFile('suite1', ['bar', 'buzz']).toString();\n    t.expect((await t.load(s)).length === 1);\n  }\n});\n\ng.test('test').fn(async t => {\n  t.shouldReject('Error', t.load('suite1::'));\n  t.shouldReject('Error', t.load('suite1:bar:'));\n  t.shouldReject('Error', t.load('suite1:bar,:'));\n\n  t.shouldReject('Error', t.load('suite1::*'));\n  t.shouldReject('Error', t.load('suite1:bar,:*'));\n  t.shouldReject('Error', t.load('suite1:bar:*'));\n\n  t.expect((await t.load('suite1:foo:*')).length === 3);\n  t.expect((await t.load('suite1:bar,buzz,buzz:*')).length === 1);\n  t.expect((await t.load('suite1:baz:*')).length === 4);\n\n  t.expect((await t.load('suite2:foof:bluh,*')).length === 1);\n  t.expect((await t.load('suite2:foof:bluh,a,*')).length === 1);\n\n  {\n    const s = new TestQueryMultiTest('suite2', ['foof'], ['bluh']).toString();\n    t.expect((await t.load(s)).length === 1);\n  }\n});\n\ng.test('case').fn(async t => {\n  t.shouldReject('Error', t.load('suite1:foo::'));\n  t.shouldReject('Error', t.load('suite1:bar:zed,:'));\n\n  t.shouldReject('Error', t.load('suite1:foo:h*'));\n\n  t.shouldReject('Error', t.load('suite1:foo::*'));\n  t.shouldReject('Error', t.load('suite1:baz::*'));\n  t.shouldReject('Error', t.load('suite1:baz:zed,:*'));\n\n  t.shouldReject('Error', t.load('suite1:baz:zed:'));\n  t.shouldReject('Error', t.load('suite1:baz:zed:a=1;b=2*'));\n  t.shouldReject('Error', t.load('suite1:baz:zed:a=1;b=2;'));\n  t.shouldReject('SyntaxError', t.load('suite1:baz:zed:a=1;b=2,')); // tries to parse '2,' as JSON\n  t.shouldReject('Error', t.load('suite1:baz:zed:a=1,b=2')); // '=' not allowed in value '1,b=2'\n  t.shouldReject('Error', t.load('suite1:baz:zed:b=2*'));\n  t.shouldReject('Error', t.load('suite1:baz:zed:b=2;a=1;_c=0'));\n  t.shouldReject('Error', t.load('suite1:baz:zed:a=1,*'));\n\n  t.expect((await t.load('suite1:baz:zed:*')).length === 2);\n  t.expect((await t.load('suite1:baz:zed:a=1;*')).length === 2);\n  t.expect((await t.load('suite1:baz:zed:a=1;b=2')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:a=1;b=2;*')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:b=2;*')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:b=2;a=1')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:b=2;a=1;*')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:b=3;a=1')).length === 1);\n  t.expect((await t.load('suite1:baz:zed:a=1;b=3')).length === 1);\n  t.expect((await t.load('suite1:foo:hello:')).length === 1);\n\n  {\n    const s = new TestQueryMultiCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }).toString();\n    t.expect((await t.load(s)).length === 1);\n  }\n  {\n    const s = new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }).toString();\n    t.expect((await t.load(s)).length === 1);\n  }\n});\n\nasync function runTestcase(\n  t: Fixture,\n  log: Logger,\n  testcases: TestTreeLeaf[],\n  i: number,\n  query: TestQuery,\n  expectations: TestQueryWithExpectation[],\n  status: Status,\n  logs: (s: string[]) => boolean\n) {\n  t.expect(objectEquals(testcases[i].query, query));\n  const name = testcases[i].query.toString();\n  const [rec, res] = log.record(name);\n  await testcases[i].run(rec, expectations);\n\n  t.expect(log.results.get(name) === res);\n  t.expect(res.status === status);\n  t.expect(res.timems >= 0);\n  assert(res.logs !== undefined); // only undefined while pending\n  t.expect(logs(res.logs.map(l => JSON.stringify(l))));\n}\n\ng.test('end2end').fn(async t => {\n  const l = await t.load('suite2:foof:*');\n  assert(l.length === 3, 'listing length');\n\n  const log = new Logger(true);\n\n  await runTestcase(\n    t,\n    log,\n    l,\n    0,\n    new TestQuerySingleCase('suite2', ['foof'], ['blah'], {}),\n    [],\n    'pass',\n    logs => objectEquals(logs, ['\"DEBUG: OK\"'])\n  );\n  await runTestcase(\n    t,\n    log,\n    l,\n    1,\n    new TestQuerySingleCase('suite2', ['foof'], ['bleh'], { a: 1 }),\n    [],\n    'pass',\n    logs => objectEquals(logs, ['\"DEBUG: OK\"', '\"DEBUG: OK\"'])\n  );\n  await runTestcase(\n    t,\n    log,\n    l,\n    2,\n    new TestQuerySingleCase('suite2', ['foof'], ['bluh', 'a'], {}),\n    [],\n    'fail',\n    logs =>\n      logs.length === 1 &&\n      logs[0].startsWith('\"EXPECTATION FAILED: goodbye\\\\n') &&\n      logs[0].indexOf('loaders_and_trees.spec.') !== -1\n  );\n});\n\ng.test('expectations,single_case').fn(async t => {\n  const log = new Logger(true);\n  const zedCases = await t.load('suite1:baz:zed:*');\n\n  // Single-case. Covers one case.\n  const zedExpectationsSkipA1B2 = [\n    {\n      query: new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    0,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    zedExpectationsSkipA1B2,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    1,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 3 }),\n    zedExpectationsSkipA1B2,\n    'pass',\n    logs => logs.length === 0\n  );\n});\n\ng.test('expectations,single_case,none').fn(async t => {\n  const log = new Logger(true);\n  const zedCases = await t.load('suite1:baz:zed:*');\n  // Single-case. Doesn't cover any cases.\n  const zedExpectationsSkipA1B0 = [\n    {\n      query: new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 0 }),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    0,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    zedExpectationsSkipA1B0,\n    'pass',\n    logs => logs.length === 0\n  );\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    1,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 3 }),\n    zedExpectationsSkipA1B0,\n    'pass',\n    logs => logs.length === 0\n  );\n});\n\ng.test('expectations,multi_case').fn(async t => {\n  const log = new Logger(true);\n  const zedCases = await t.load('suite1:baz:zed:*');\n  // Multi-case, not all cases covered.\n  const zedExpectationsSkipB3 = [\n    {\n      query: new TestQueryMultiCase('suite1', ['baz'], ['zed'], { b: 3 }),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    0,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    zedExpectationsSkipB3,\n    'pass',\n    logs => logs.length === 0\n  );\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    1,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 3 }),\n    zedExpectationsSkipB3,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,multi_case_all').fn(async t => {\n  const log = new Logger(true);\n  const zedCases = await t.load('suite1:baz:zed:*');\n  // Multi-case, all cases covered.\n  const zedExpectationsSkipA1 = [\n    {\n      query: new TestQueryMultiCase('suite1', ['baz'], ['zed'], { a: 1 }),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    0,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    zedExpectationsSkipA1,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    1,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 3 }),\n    zedExpectationsSkipA1,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,multi_case_none').fn(async t => {\n  const log = new Logger(true);\n  const zedCases = await t.load('suite1:baz:zed:*');\n  // Multi-case, no params, all cases covered.\n  const zedExpectationsSkipZed = [\n    {\n      query: new TestQueryMultiCase('suite1', ['baz'], ['zed'], {}),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    0,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    zedExpectationsSkipZed,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    zedCases,\n    1,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 3 }),\n    zedExpectationsSkipZed,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,multi_test').fn(async t => {\n  const log = new Logger(true);\n  const suite1Cases = await t.load('suite1:*');\n\n  // Multi-test, all cases covered.\n  const expectationsSkipAllInBaz = [\n    {\n      query: new TestQueryMultiTest('suite1', ['baz'], []),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    4,\n    new TestQuerySingleCase('suite1', ['baz'], ['wye'], {}),\n    expectationsSkipAllInBaz,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    6,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    expectationsSkipAllInBaz,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,multi_test,none').fn(async t => {\n  const log = new Logger(true);\n  const suite1Cases = await t.load('suite1:*');\n\n  // Multi-test, no cases covered.\n  const expectationsSkipAllInFoo = [\n    {\n      query: new TestQueryMultiTest('suite1', ['foo'], []),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    4,\n    new TestQuerySingleCase('suite1', ['baz'], ['wye'], {}),\n    expectationsSkipAllInFoo,\n    'pass',\n    logs => logs.length === 0\n  );\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    6,\n    new TestQuerySingleCase('suite1', ['baz'], ['zed'], { a: 1, b: 2 }),\n    expectationsSkipAllInFoo,\n    'pass',\n    logs => logs.length === 0\n  );\n});\n\ng.test('expectations,multi_file').fn(async t => {\n  const log = new Logger(true);\n  const suite1Cases = await t.load('suite1:*');\n\n  // Multi-file\n  const expectationsSkipAll = [\n    {\n      query: new TestQueryMultiFile('suite1', []),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    0,\n    new TestQuerySingleCase('suite1', ['foo'], ['hello'], {}),\n    expectationsSkipAll,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    suite1Cases,\n    3,\n    new TestQuerySingleCase('suite1', ['bar', 'buzz', 'buzz'], ['zap'], {}),\n    expectationsSkipAll,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,catches_failure').fn(async t => {\n  const log = new Logger(true);\n  const suite2Cases = await t.load('suite2:*');\n\n  // Catches failure\n  const expectedFailures = [\n    {\n      query: new TestQueryMultiCase('suite2', ['foof'], ['bluh', 'a'], {}),\n      expectation: 'fail' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite2Cases,\n    0,\n    new TestQuerySingleCase('suite2', ['foof'], ['blah'], {}),\n    expectedFailures,\n    'pass',\n    logs => objectEquals(logs, ['\"DEBUG: OK\"'])\n  );\n\n  // Status is passed, but failure is logged.\n  await runTestcase(\n    t,\n    log,\n    suite2Cases,\n    2,\n    new TestQuerySingleCase('suite2', ['foof'], ['bluh', 'a'], {}),\n    expectedFailures,\n    'pass',\n    logs => logs.length === 1 && logs[0].startsWith('\"EXPECTATION FAILED: goodbye\\\\n')\n  );\n});\n\ng.test('expectations,skip_dominates_failure').fn(async t => {\n  const log = new Logger(true);\n  const suite2Cases = await t.load('suite2:*');\n\n  const expectedFailures = [\n    {\n      query: new TestQueryMultiCase('suite2', ['foof'], ['bluh', 'a'], {}),\n      expectation: 'fail' as const,\n    },\n    {\n      query: new TestQueryMultiCase('suite2', ['foof'], ['bluh', 'a'], {}),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite2Cases,\n    2,\n    new TestQuerySingleCase('suite2', ['foof'], ['bluh', 'a'], {}),\n    expectedFailures,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n});\n\ng.test('expectations,skip_inside_failure').fn(async t => {\n  const log = new Logger(true);\n  const suite2Cases = await t.load('suite2:*');\n\n  const expectedFailures = [\n    {\n      query: new TestQueryMultiFile('suite2', []),\n      expectation: 'fail' as const,\n    },\n    {\n      query: new TestQueryMultiCase('suite2', ['foof'], ['blah'], {}),\n      expectation: 'skip' as const,\n    },\n  ];\n\n  await runTestcase(\n    t,\n    log,\n    suite2Cases,\n    0,\n    new TestQuerySingleCase('suite2', ['foof'], ['blah'], {}),\n    expectedFailures,\n    'skip',\n    logs => logs.length === 1 && logs[0].startsWith('\"SKIP: Skipped by expectations\"')\n  );\n\n  await runTestcase(\n    t,\n    log,\n    suite2Cases,\n    2,\n    new TestQuerySingleCase('suite2', ['foof'], ['bluh', 'a'], {}),\n    expectedFailures,\n    'pass',\n    logs => logs.length === 1 && logs[0].startsWith('\"EXPECTATION FAILED: goodbye\\\\n')\n  );\n});\n\nasync function testIterateCollapsed(\n  t: LoadingTest,\n  expectations: string[],\n  expectedResult: 'throws' | string[],\n  includeEmptySubtrees = false\n) {\n  const treePromise = LoadingTest.loader.loadTree(\n    new TestQueryMultiFile('suite1', []),\n    expectations\n  );\n  if (expectedResult === 'throws') {\n    t.shouldReject('Error', treePromise, 'loadTree should have thrown Error');\n    return;\n  }\n  const tree = await treePromise;\n  const actual = Array.from(tree.iterateCollapsedQueries(includeEmptySubtrees), q => q.toString());\n  if (!objectEquals(actual, expectedResult)) {\n    t.fail(\n      `iterateCollapsed failed:\n  got [${actual.join(', ')}]\n  exp [${expectedResult.join(', ')}]\n${tree.toString()}`\n    );\n  }\n}\n\ng.test('print').fn(async () => {\n  const tree = await LoadingTest.loader.loadTree(new TestQueryMultiFile('suite1', []));\n  tree.toString();\n});\n\ng.test('iterateCollapsed').fn(async t => {\n  // Expectations lists that have no effect\n  await testIterateCollapsed(t, [], ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:*']);\n  await testIterateCollapsed(\n    t,\n    ['suite1:foo:*'],\n    ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:*']\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:bar,buzz,buzz:*'],\n    ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:*']\n  );\n  // Test with includeEmptySubtrees=true\n  await testIterateCollapsed(\n    t,\n    [],\n    [\n      'suite1:foo:*',\n      'suite1:bar,biz:*',\n      'suite1:bar,buzz,buzz:*',\n      'suite1:baz:*',\n      'suite1:empty,*',\n    ],\n    true\n  );\n\n  // Expectations lists that have some effect\n  await testIterateCollapsed(\n    t,\n    ['suite1:baz:wye:*'],\n    ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:wye:*', 'suite1:baz:zed,*']\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:baz:zed:*'],\n    ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:wye,*', 'suite1:baz:zed:*']\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:baz:wye:*', 'suite1:baz:zed:*'],\n    ['suite1:foo:*', 'suite1:bar,buzz,buzz:*', 'suite1:baz:wye:*', 'suite1:baz:zed:*']\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:baz:wye:'],\n    [\n      'suite1:foo:*',\n      'suite1:bar,buzz,buzz:*',\n      'suite1:baz:wye:',\n      'suite1:baz:wye:x=1;*',\n      'suite1:baz:zed,*',\n    ]\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:baz:wye:x=1'],\n    [\n      'suite1:foo:*',\n      'suite1:bar,buzz,buzz:*',\n      'suite1:baz:wye:',\n      'suite1:baz:wye:x=1',\n      'suite1:baz:zed,*',\n    ]\n  );\n  await testIterateCollapsed(\n    t,\n    ['suite1:foo:*', 'suite1:baz:wye:'],\n    [\n      'suite1:foo:*',\n      'suite1:bar,buzz,buzz:*',\n      'suite1:baz:wye:',\n      'suite1:baz:wye:x=1;*',\n      'suite1:baz:zed,*',\n    ]\n  );\n\n  // Invalid expectation queries\n  await testIterateCollapsed(t, ['garbage'], 'throws');\n  await testIterateCollapsed(t, ['garbage*'], 'throws');\n  await testIterateCollapsed(t, ['suite1*'], 'throws');\n  await testIterateCollapsed(t, ['suite1:foo*'], 'throws');\n  await testIterateCollapsed(t, ['suite1:foo:he*'], 'throws');\n\n  // Valid expectation queries but they don't match anything\n  await testIterateCollapsed(t, ['garbage:*'], 'throws');\n  await testIterateCollapsed(t, ['suite1:doesntexist:*'], 'throws');\n  await testIterateCollapsed(t, ['suite2:foo:*'], 'throws');\n  // Can't expand subqueries bigger than one suite.\n  await testIterateCollapsed(t, ['suite1:*'], 'throws');\n  await testIterateCollapsed(t, ['suite1:bar,*'], 'throws');\n});\n"],"file":"loaders_and_trees.spec.js"}